<h3><%= link_to t('year_in_review_music_tracks.index.short_title', year: params[:year]), group_or_user_path('music_year_in_review_top_tracks', @year_in_review) %></h3>

<% if @year_in_review_tracks.none? %>
<p><%= t('year_in_review_music_tracks.index.empty_collection') %></p>
<% else %>
<table class="table" style="margin-bottom: 0px">
  <thead>
    <tr class="<%= cycle('odd', 'even') %>">
      <th style="width: 50px;"><%= t("attributes.position") %></th>
      <th style="width: 200px;"><%= t("music_artists.model.short_name") %></th>
      <th style="width: 200px;"><%= t("attributes.name") %></th>
      <th style="width: 50px"></th>
      <th style="width: 75px;"><%= t("activerecord.attributes.music_release.released_at") %></th>
      <th></th>
    </tr>
  </thead>
</table>   

<%= javascript_tag do %>
  window.matches = <%= raw @year_in_review.top_track_matches.to_json %>
<% end %> 
   
<ul class="nav nav-tabs nav-stacked list-striped multisortable competitive_list" id="year_in_review_music_tracks" data-update-all-positions-path="<%= update_all_positions_music_year_in_review_top_track_path(@year_in_review.year) %>">
  <%= render partial: 'library/music/year_in_review_tracks/year_in_review_track', collection: @year_in_review_tracks %>
</ul>
<% end %>

<% if @group.blank? && current_user.try(:id) == params[:user_id].to_i %>
  <%= link_to(
    t('year_in_review_music_tracks.index.add_single'), new_user_music_year_in_review_top_track_path(params[:user_id], params[:year]), 
    class: 'remote_modal_link'
  ) %> | 
  <%= link_to(
    t('year_in_review_music_tracks.index.add_multiple_from_year', year: params[:year]), multiple_new_user_music_year_in_review_top_tracks_path(params[:year]), 
    class: 'remote_modal_link'
  ) %> | 
  <%= link_to(
    t('general.sort_through_round_robin_tournament'), '#', class: 'competitive_list_start_link'
  ) %> |
<% end %>

<% if @group.present? || current_user.try(:id) == params[:user_id].to_i %>
  <%= link_to t('general.export'), group_or_user_path('export_music_year_in_review_top_tracks', params[:year]), class: 'remote_modal_link' %>
<% end %>
